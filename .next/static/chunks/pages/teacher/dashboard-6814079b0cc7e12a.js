(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[599],{3546:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/teacher/dashboard",function(){return s(7197)}])},7197:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(7876),i=s(4232),a=s(9099);function o(){let[e,t]=(0,i.useState)([]),[s,o]=(0,i.useState)(!0),[n,l]=(0,i.useState)(null),[d,m]=(0,i.useState)(!1),[c,u]=(0,i.useState)(null),[x,g]=(0,i.useState)({title:"",description:"",googleFormUrl:"",dueDate:""}),[h,f]=(0,i.useState)(""),p=(0,a.useRouter)();(0,i.useEffect)(()=>{let e=localStorage.getItem("token");if(!e)return void p.push("/teacher/login");b(e),j(e)},[]);let b=async e=>{try{let t=await fetch("/api/auth/profile",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();l(e)}else localStorage.removeItem("token"),p.push("/teacher/login")}catch(e){console.error("Error mengambil data pengguna:",e)}},j=async e=>{try{let s=await fetch("/api/forms",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();t(e)}}catch(e){console.error("Error mengambil formulir:",e)}finally{o(!1)}},y=()=>{u(null),g({title:"",description:"",googleFormUrl:"",dueDate:""}),m(!0)},w=()=>{m(!1),u(null),f("")},N=async e=>{e.preventDefault();let t=localStorage.getItem("token");try{let e=c?"/api/forms/".concat(c._id):"/api/forms",s=c?"PUT":"POST",r=await fetch(e,{method:s,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(x)});if(r.ok)w(),j(t);else{let e=await r.json();f(e.message||"Operasi gagal")}}catch(e){f("Terjadi kesalahan"),console.error(e)}},v=async e=>{if(!confirm("Apakah Anda yakin ingin menghapus formulir ini?"))return;let t=localStorage.getItem("token");try{let s=await fetch("/api/forms/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}});if(s.ok)j(t);else{let e=await s.json();alert(e.message||"Gagal menghapus")}}catch(e){console.error("Error menghapus formulir:",e),alert("Terjadi kesalahan saat menghapus formulir")}},k=e=>{g({...x,[e.target.name]:e.target.value})};return s?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("p",{children:"Memuat dashboard..."})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("header",{className:"bg-white shadow",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Guru"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[n&&(0,r.jsxs)("span",{className:"text-gray-700",children:["Halo, ",n.name]}),(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),p.push("/teacher/login")},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Keluar"})]})]})}),(0,r.jsx)("main",{children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Formulir Anda"}),(0,r.jsx)("button",{onClick:y,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Tambah Formulir Baru"})]}),0===e.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Belum ada formulir"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Mulai dengan membuat formulir baru."}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)("button",{onClick:y,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Tambah Formulir Baru"})})]}):(0,r.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,r.jsx)("ul",{className:"divide-y divide-gray-200",children:e.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("div",{className:"px-4 py-4 sm:px-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-indigo-600 truncate",children:e.title}),(0,r.jsx)("div",{className:"ml-2 flex-shrink-0 flex",children:(0,r.jsxs)("p",{className:"inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:["Berakhir: ",new Date(e.dueDate).toLocaleDateString("id-ID")]})})]}),(0,r.jsxs)("div",{className:"mt-2 sm:flex sm:justify-between",children:[(0,r.jsx)("div",{className:"sm:flex",children:(0,r.jsx)("p",{className:"flex items-center text-sm text-gray-500",children:e.description})}),(0,r.jsxs)("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:[(0,r.jsx)("button",{onClick:()=>{u(e),g({title:e.title,description:e.description,googleFormUrl:e.googleFormUrl,dueDate:new Date(e.dueDate).toISOString().split("T")[0]}),m(!0)},className:"mr-3 text-indigo-600 hover:text-indigo-900",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>v(e._id),className:"text-red-600 hover:text-red-900",children:"Hapus"})]})]})]})},e._id))})})]})})}),d&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:w})}),(0,r.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,r.jsxs)("form",{onSubmit:N,children:[(0,r.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:c?"Edit Formulir":"Tambah Formulir Baru"}),h&&(0,r.jsx)("div",{className:"rounded-md bg-red-50 p-4 mb-4",children:(0,r.jsx)("div",{className:"text-sm text-red-700",children:h})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Judul"}),(0,r.jsx)("input",{type:"text",name:"title",id:"title",value:x.title,onChange:k,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Deskripsi"}),(0,r.jsx)("textarea",{name:"description",id:"description",rows:3,value:x.description,onChange:k,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"googleFormUrl",className:"block text-sm font-medium text-gray-700",children:"URL Google Form"}),(0,r.jsx)("input",{type:"url",name:"googleFormUrl",id:"googleFormUrl",value:x.googleFormUrl,onChange:k,required:!0,placeholder:"https://docs.google.com/forms/d/e/.../viewform",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Berakhir"}),(0,r.jsx)("input",{type:"date",name:"dueDate",id:"dueDate",value:x.dueDate,onChange:k,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",children:c?"Perbarui":"Buat"}),(0,r.jsx)("button",{type:"button",onClick:w,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Batal"})]})]})})]})})]})}s(8230)}},e=>{e.O(0,[8,636,593,792],()=>e(e.s=3546)),_N_E=e.O()}]);